⭐️ 톱 레벨 클래스는 한 파일에 하나만 담으라

소스 파일 하나에 톱레벨 클래스를 여러 개 선언하더라도 자바 컴파일러는 불평하지 않는다.
하지만 아무런 득이 없을 뿐더러 심각한 위험을 감수해야 하는 행위다.
이렇게 하면 한 클래스를 여러 가지로 정의할 수 있으며, 그중 어느 것을 사용할지는 어느 소스 파일을 먼저 컴파일하느냐에 따라 달라지기 때문이다.

예를 보자. 소스 파일은 Main 클래스 하나를 담고 있고, Main 클래스는 다른 톱레벨 클래스 2개 Utensil과 Dessert를 참조한다.

해결책은 간단하다.
단순히 톱레벨 클래스들 (Utensil과 Dessert)을 서로 다른 소스 파일로 분리하면 그만이다.
굳이 여러 톱레벨 클래스를 한 파일에 담고 싶다면 정적 멤버 클래스를 사용하는 방법을 고민해볼 수 있다. (펙터리 메서드 만드는 것처럼?)
읽기 좋고, private으로 선언하면 접근 범위도 최소로 관리할 수 있기 때문이다. 다음 코드는 앞의 예를 정적 멤버 클래스로 바꿔본 예다.

핵심정리
소스 파일 하나에는 반드시 톱레벨 클래스(혹은 톱레벨 인터페이스)를 하나만 담자. 이 규칙만 따른다면 컴파일러가 한 클래스에 대한 정의를 여러 개 만들어 내는 일은 사라진다.
소스 파일을 어떤 순서로 컴파일하든 바이너리 파일이나 프로그램의 동작이 달라지는 일은 결코 일어나지 않을 것이다.
